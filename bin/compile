#!/bin/sh

# This is a Heroku buildpack script: https://devcenter.heroku.com/articles/buildpack-api

set -eu

BUILD_DIR="$1"
CACHE_DIR="$2"

METABASE_VERSION=`cat $BUILD_DIR/metabase-version`
METABASE_DIR="$BUILD_DIR/target/uberjar"

METABASE_JAR="$METABASE_DIR/metabase.jar"

mkdir -p "$METABASE_DIR"
mkdir -p "$CACHE_DIR"

if ! [ -f "$METABASE_JAR" ]; then
  echo " !     Metabase jar not compiled. "
  exit 1
fi

echo "-----> Verifying JAR signature... "
jarsigner -verify "$METABASE_JAR"
echo "done"
